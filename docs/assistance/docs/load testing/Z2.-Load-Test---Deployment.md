# Server preparation
To install docker run:
```bash
cd Docker Environment/Load Testing/Install
sh install_docker.sh
```

# Run services
## General order
* Prometheus | Cassandra | Postgres | ActiveMQ
* cAdvisor | Node Exporter (if horizontal, per Node)
* REST Server
* Load Balancer
* Module

## Prometheus (Central Monitoring)
NOTE: The config has to be adjusted for each cAdvisor node!

```bash
cd Load Testing/Start Services
sh start_prometheus.sh
```

## cAdvisor (Local Monitoring per Node)
**PER NODE!!!!**
```bash
cd Load Testing/Start Services
sh start_advisorc.sh
```

## Node Exporter (Local System Monitoring per Node)
**PER NODE!!!!!!**
```bash
cd Load Testing/Start Services
sh start_exporter.sh
```

## ActiveMQ
```bash
cd Load Testing/Start Services
sh start_activemq.sh
```

## Postgres
```bash
cd Load Testing/Start Services
sh start_postgres.sh
```

## Cassandra
* $1 = Broadcast Address (IP von Maschine)
* $2 = Seeds Adresses (IP(s) von anderen Cassandra Maschinen) 

$2 wird nur benötigt, wenn ein Cluster gebaut werden soll

```bash
cd Load Testing/Start Services
sh start_postgres.sh $1 $2
```

## Assistance Platform REST
* $1 = ActiveMQ IP
* $2 = ActiveMQ Port
* $3 = Postgres IP
* $4 = Postgres Port
* $5 = Cassandra IP

```bash
cd Load Testing/Start Services
sh start_assi.sh $1 $2 $3 $4 $5
```

## Load Balancer (web)
NOTE: Benötigt manuelle Anpassung siehe Unterabschnitt.

```bash
cd Load Testing/Start Services/loadbalancer
sh start_loadbalancer.sh
```

### REST Server hinzufügen
`Load Testing/Start Services/loadbalancer/nginx_config/sites-enabled/assistance` öffnen und im `upstream assi` Block entsprechend die Server eintragen.

### Mehr als 1024 Connections?
Wenn es um mehr als 1024 Connections geht, ggf. `Load Testing/Start Services/loadbalancer/nginx_config/nginx.conf` anpassen.