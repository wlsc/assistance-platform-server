package de.tudarmstadt.informatik.tk.assistanceplatform.moduleregistry

import scala.collection.mutable;
import de.tudarmstadt.informatik.tk.assistanceplatform.modules.registry.exceptions.ModuleRegistrationException

/**
 * @author bjeutter
 * This class keeps track of registered modules on the central platform.
 */
class ModuleRegistry {
  /**
   * List of current registrations
   */
  private val registrations = scala.collection.mutable.Set[ModuleRegistration]() // TODO: ggf. peristent machen
  
  /**
   * Returns the current registrations as a list
   */
  def currentRegistrations = registrations.toList
  
  /**
   * Tries to register a module
   */
   def registerModule(registration : ModuleRegistration) {
     if(isRegistrationValid(registration)) {
         this.registrations += registration
     }
   }
  
  /**
   * Checks if a registration is valid
   */
   private def isRegistrationValid(registration : ModuleRegistration) : Boolean = {
     val test = registrations.find((r : ModuleRegistration) => r.id == registration.id) 
     if(registrations.find((r : ModuleRegistration) => r.id == registration.id) != None) {
       throw new ModuleRegistrationException("Module ID already registered.")
     }
     
     return true
  }
   
   /**
    * Deregister a module with certain ID
    */
   def deregisterModule(moduleId : String) {
   }
   
  /**
   * Deregisters a module
   */
   def deregisterModule(registration : ModuleRegistration) {
     deregisterModule(registration.id);
   }
}